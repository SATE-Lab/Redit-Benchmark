[2022-08-25 08:36:56,785] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2022-08-25 08:36:57,490] INFO Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation (org.apache.zookeeper.common.X509Util)
[2022-08-25 08:36:58,124] INFO [Log partition=@metadata-0, dir=/kafka/kafka_2.13-2.8.0/logs] Loading producer state till offset 0 with message format version 2 (kafka.log.Log)
[2022-08-25 08:36:58,265] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2022-08-25 08:36:58,734] INFO [RaftManager nodeId=3] Completed transition to Unattached(epoch=0, voters=[1, 2, 3], electionTimeoutMs=1856) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:36:58,789] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2022-08-25 08:36:58,821] INFO [kafka-raft-outbound-request-thread]: Starting (kafka.raft.RaftSendThread)
[2022-08-25 08:36:58,837] INFO Starting controller (kafka.server.ControllerServer)
[2022-08-25 08:36:58,848] INFO [kafka-raft-io-thread]: Starting (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:36:59,856] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2022-08-25 08:36:59,870] INFO Awaiting socket connections on 0.0.0.0:19091. (kafka.network.Acceptor)
[2022-08-25 08:36:59,993] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2022-08-25 08:37:00,093] INFO [ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,094] INFO [ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,097] INFO [ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,120] INFO [ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,155] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Starting socket server acceptors and processors (kafka.network.SocketServer)
[2022-08-25 08:37:00,180] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Started data-plane acceptor and processor(s) for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2022-08-25 08:37:00,185] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Started socket server acceptors and processors (kafka.network.SocketServer)
[2022-08-25 08:37:00,190] INFO [BrokerServer id=3] Starting broker (kafka.server.BrokerServer)
[2022-08-25 08:37:00,197] INFO [RaftManager nodeId=3] Completed transition to Candidate(localId=3, epoch=1, retries=1, electionTimeoutMs=1327) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:00,208] INFO [ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,213] INFO [ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,217] INFO [ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,259] INFO [ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,423] WARN [RaftManager nodeId=3] Connection to node 2 (/10.5.0.3:19091) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2022-08-25 08:37:00,565] INFO [broker-3-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:00,696] INFO [RaftManager nodeId=3] Vote request VoteRequestData(clusterId=null, topics=[TopicData(topicName='@metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=1, candidateId=2, lastOffsetEpoch=0, lastOffset=0)])]) is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:00,713] INFO [RaftManager nodeId=3] Vote request VoteRequestData(clusterId=null, topics=[TopicData(topicName='@metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=1, candidateId=1, lastOffsetEpoch=0, lastOffset=0)])]) is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:00,812] INFO [RaftManager nodeId=3] Completed transition to Unattached(epoch=2, voters=[1, 2, 3], electionTimeoutMs=705) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:00,816] INFO [RaftManager nodeId=3] Completed transition to Voted(epoch=2, votedId=2, voters=[1, 2, 3], electionTimeoutMs=1973) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:00,816] INFO [RaftManager nodeId=3] Vote request VoteRequestData(clusterId=null, topics=[TopicData(topicName='@metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=2, candidateId=2, lastOffsetEpoch=0, lastOffset=0)])]) is granted (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:00,898] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2022-08-25 08:37:00,898] INFO Awaiting socket connections on 0.0.0.0:9092. (kafka.network.Acceptor)
[2022-08-25 08:37:00,937] INFO [SocketServer listenerType=BROKER, nodeId=3] Created data-plane acceptor and processors for endpoint : ListenerName(PLAINTEXT) (kafka.network.SocketServer)
[2022-08-25 08:37:00,972] INFO [broker-3-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,048] INFO [ExpirationReaper-3-Fetch]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,066] INFO [ExpirationReaper-3-Produce]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,066] INFO [ExpirationReaper-3-ElectLeader]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,066] INFO [ExpirationReaper-3-DeleteRecords]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,144] INFO [ExpirationReaper-3-Heartbeat]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,144] INFO [ExpirationReaper-3-Rebalance]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,210] INFO [RaftManager nodeId=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=2, leaderId=2, voters=[1, 2, 3]) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:01,285] INFO [broker-3-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,292] INFO [broker-3-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,316] INFO [broker-3-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,316] INFO [broker-3-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,496] INFO [BrokerLifecycleManager id=3] Incarnation z2h4GJ2uT-a7OZbKL0LP4w of broker 3 in cluster PHc7E0K_QfWCJcvTMswIXg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2022-08-25 08:37:01,501] INFO [broker-3-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,501] INFO [broker-3-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,524] ERROR [broker-3-to-controller-send-thread]: unhandled exception caught in InterBrokerSendThread (kafka.server.BrokerToControllerRequestThread)
java.lang.NullPointerException
	at org.apache.kafka.common.message.BrokerRegistrationRequestData$Listener.addSize(BrokerRegistrationRequestData.java:515)
	at org.apache.kafka.common.message.BrokerRegistrationRequestData.addSize(BrokerRegistrationRequestData.java:216)
	at org.apache.kafka.common.protocol.SendBuilder.buildSend(SendBuilder.java:218)
	at org.apache.kafka.common.protocol.SendBuilder.buildRequestSend(SendBuilder.java:187)
	at org.apache.kafka.common.requests.AbstractRequest.toSend(AbstractRequest.java:101)
	at org.apache.kafka.clients.NetworkClient.doSend(NetworkClient.java:525)
	at org.apache.kafka.clients.NetworkClient.doSend(NetworkClient.java:501)
	at org.apache.kafka.clients.NetworkClient.send(NetworkClient.java:461)
	at kafka.common.InterBrokerSendThread.$anonfun$sendRequests$1(InterBrokerSendThread.scala:104)
	at kafka.common.InterBrokerSendThread.$anonfun$sendRequests$1$adapted(InterBrokerSendThread.scala:99)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.common.InterBrokerSendThread.sendRequests(InterBrokerSendThread.scala:99)
	at kafka.common.InterBrokerSendThread.pollOnce(InterBrokerSendThread.scala:73)
	at kafka.server.BrokerToControllerRequestThread.doWork(BrokerToControllerChannelManager.scala:368)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-25 08:37:01,549] INFO [broker-3-to-controller-send-thread]: Stopped (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,550] INFO [kafka-raft-io-thread]: Shutting down (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,550] INFO [RaftManager nodeId=3] Beginning graceful shutdown (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:01,685] INFO [RaftManager nodeId=3] Graceful shutdown completed (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:01,685] INFO [kafka-raft-io-thread]: Completed graceful shutdown of RaftClient (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,696] INFO [kafka-raft-io-thread]: Shutdown completed (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,705] INFO [kafka-raft-io-thread]: Stopped (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,722] INFO [kafka-raft-outbound-request-thread]: Shutting down (kafka.raft.RaftSendThread)
[2022-08-25 08:37:01,724] INFO [kafka-raft-outbound-request-thread]: Stopped (kafka.raft.RaftSendThread)
[2022-08-25 08:37:01,724] INFO [kafka-raft-outbound-request-thread]: Shutdown completed (kafka.raft.RaftSendThread)
[2022-08-25 08:37:01,857] INFO [ExpirationReaper-3-AlterAcls]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,869] INFO [ProducerStateManager partition=@metadata-0] Writing producer snapshot at offset 1 (kafka.log.ProducerStateManager)
[2022-08-25 08:37:01,911] INFO [ControllerServer id=3] shutting down (kafka.server.ControllerServer)
[2022-08-25 08:37:01,912] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Stopping socket server request processors (kafka.network.SocketServer)
[2022-08-25 08:37:02,008] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Stopped socket server request processors (kafka.network.SocketServer)
[2022-08-25 08:37:02,009] INFO [Controller 3] QuorumController#beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2022-08-25 08:37:02,058] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Shutting down socket server (kafka.network.SocketServer)
[2022-08-25 08:37:02,124] INFO [SocketServer listenerType=CONTROLLER, nodeId=3] Shutdown completed (kafka.network.SocketServer)
[2022-08-25 08:37:02,136] INFO [data-plane Kafka Request Handler on Broker 3], shutting down (kafka.server.KafkaRequestHandlerPool)
[2022-08-25 08:37:02,149] INFO [data-plane Kafka Request Handler on Broker 3], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2022-08-25 08:37:02,150] INFO [ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,095] INFO [ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,095] INFO [ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,095] INFO [ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,098] INFO [ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,098] INFO [ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,098] INFO [ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:04,099] INFO [ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:04,099] INFO [ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:04,099] INFO [ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:04,122] INFO [ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:04,123] INFO [ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:04,124] INFO [Controller 3] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2022-08-25 08:37:04,124] INFO App info kafka.server for 3 unregistered (org.apache.kafka.common.utils.AppInfoParser)
