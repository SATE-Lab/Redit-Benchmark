10:56:53.284 [main] INFO  i.r.samples.activemq8050.SampleTest - wait for Rocketmq ...
10:56:53.284 [main] INFO  i.r.samples.activemq8050.SampleTest - server1 startServer...
10:56:56.065 [main] INFO  i.r.samples.activemq8050.SampleTest - server2 startServer...
10:57:08.861 [main] INFO  i.r.samples.activemq8050.SampleTest - server1 checkServer...
10:57:09.207 [main] INFO  i.r.samples.activemq8050.SampleTest - server1: cd /activemq/activemq-5.15.3/mq1 && bin/activemq status
10:57:09.207 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq1//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '47')

10:57:09.207 [main] INFO  i.r.samples.activemq8050.SampleTest - server1: cd /activemq/activemq-5.15.3/mq2 && bin/activemq status
10:57:09.207 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq2//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '92')

10:57:09.207 [main] INFO  i.r.samples.activemq8050.SampleTest - server1: cd /activemq/activemq-5.15.3/mq3 && bin/activemq status
10:57:09.207 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq3//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '139')

10:57:11.207 [main] INFO  i.r.samples.activemq8050.SampleTest - server2 checkServer...
10:57:11.523 [main] INFO  i.r.samples.activemq8050.SampleTest - server2: cd /activemq/activemq-5.15.3/mq1 && bin/activemq status
10:57:11.523 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq1//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '47')

10:57:11.523 [main] INFO  i.r.samples.activemq8050.SampleTest - server2: cd /activemq/activemq-5.15.3/mq2 && bin/activemq status
10:57:11.523 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq2//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '93')

10:57:11.523 [main] INFO  i.r.samples.activemq8050.SampleTest - server2: cd /activemq/activemq-5.15.3/mq3 && bin/activemq status
10:57:11.523 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq3//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '138')

10:57:15.551 [main] DEBUG o.a.a.thread.TaskRunnerFactory - Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@3fae596[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
10:57:15.553 [main] DEBUG o.a.a.t.failover.FailoverTransport - Reconnect was triggered but transport is not started yet. Wait for start to connect the transport.
10:57:15.673 [main] DEBUG o.a.a.t.failover.FailoverTransport - Started unconnected
10:57:15.673 [main] DEBUG o.a.a.t.failover.FailoverTransport - Waking up reconnect task
10:57:15.674 [ActiveMQ Task-1] DEBUG o.a.a.t.failover.FailoverTransport - urlList connectionList:[tcp://10.15.0.2:61616, tcp://10.15.0.3:61616], from: [tcp://10.15.0.2:61616, tcp://10.15.0.3:61616]
10:57:15.700 [ActiveMQ Task-1] DEBUG o.a.a.t.failover.FailoverTransport - Attempting 0th connect to: tcp://10.15.0.2:61616
10:57:15.705 [ActiveMQ Task-1] DEBUG o.a.a.transport.WireFormatNegotiator - Sending: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=9223372036854775807, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.711 [ActiveMQ Task-1] DEBUG o.a.a.t.failover.FailoverTransport - Connection established
10:57:15.712 [ActiveMQ Task-1] INFO  o.a.a.t.failover.FailoverTransport - Successfully connected to tcp://10.15.0.2:61616
10:57:15.718 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40872] DEBUG o.a.a.transport.InactivityMonitor - Using min of local: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=9223372036854775807, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]} and remote: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=104857600, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.718 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40872] DEBUG o.a.a.transport.WireFormatNegotiator - Received WireFormat: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=104857600, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.718 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40872] DEBUG o.a.a.transport.WireFormatNegotiator - tcp:///10.15.0.2:61616@40872 before negotiation: OpenWireFormat{version=12, cacheEnabled=false, stackTraceEnabled=false, tightEncodingEnabled=false, sizePrefixDisabled=false, maxFrameSize=9223372036854775807}
10:57:15.719 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40872] DEBUG o.a.a.transport.WireFormatNegotiator - tcp:///10.15.0.2:61616@40872 after negotiation: OpenWireFormat{version=12, cacheEnabled=true, stackTraceEnabled=true, tightEncodingEnabled=true, sizePrefixDisabled=false, maxFrameSize=104857600}
10:57:15.743 [main] DEBUG o.apache.activemq.TransactionContext - Start: io.redit.samples.activemq8050.SampleTest$1@64c4c01, flags: TMNOFLAGS
10:57:15.745 [main] DEBUG o.apache.activemq.TransactionContext - TransactionContext{transactionId=XID:[86,globalId=001ffffff83684721ffffffe0,branchId=001ffffff83684721ffffffe0],connection=ActiveMQConnection {id=ID:zmb-virtual-machine-33791-1663901835569-1:1,clientId=PRODUCER,started=true}} started XA transaction XID:[86,globalId=001ffffff83684721ffffffe0,branchId=001ffffff83684721ffffffe0]
10:57:15.798 [main] DEBUG o.apache.activemq.TransactionContext - End: io.redit.samples.activemq8050.SampleTest$1@64c4c01, flags: TMSUCCESS
10:57:15.807 [main] DEBUG o.apache.activemq.TransactionContext - TransactionContext{transactionId=XID:[86,globalId=001ffffff83684721ffffffe0,branchId=001ffffff83684721ffffffe0],connection=ActiveMQConnection {id=ID:zmb-virtual-machine-33791-1663901835569-1:1,clientId=PRODUCER,started=true}} ended XA transaction XID:[86,globalId=001ffffff83684721ffffffe0,branchId=001ffffff83684721ffffffe0]
10:57:15.807 [main] DEBUG o.apache.activemq.TransactionContext - Prepare: io.redit.samples.activemq8050.SampleTest$1@64c4c01
10:57:15.810 [main] DEBUG o.apache.activemq.TransactionContext - Commit: io.redit.samples.activemq8050.SampleTest$1@64c4c01, onePhase=false
10:57:15.819 [main] DEBUG o.a.a.thread.TaskRunnerFactory - Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@4393593c[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
10:57:15.819 [main] DEBUG o.a.a.t.failover.FailoverTransport - Reconnect was triggered but transport is not started yet. Wait for start to connect the transport.
10:57:15.820 [main] DEBUG o.a.a.t.failover.FailoverTransport - Started unconnected
10:57:15.820 [main] DEBUG o.a.a.t.failover.FailoverTransport - Waking up reconnect task
10:57:15.825 [ActiveMQ Task-1] DEBUG o.a.a.t.failover.FailoverTransport - urlList connectionList:[tcp://10.15.0.2:61616, tcp://10.15.0.3:61616], from: [tcp://10.15.0.2:61616, tcp://10.15.0.3:61616]
10:57:15.826 [ActiveMQ Task-1] DEBUG o.a.a.t.failover.FailoverTransport - Attempting 0th connect to: tcp://10.15.0.2:61616
10:57:15.828 [ActiveMQ Task-1] DEBUG o.a.a.transport.WireFormatNegotiator - Sending: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=9223372036854775807, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.834 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40874] DEBUG o.a.a.transport.InactivityMonitor - Using min of local: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=9223372036854775807, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]} and remote: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=104857600, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.835 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40874] DEBUG o.a.a.transport.WireFormatNegotiator - Received WireFormat: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=104857600, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.842 [ActiveMQ Task-1] DEBUG o.a.a.t.failover.FailoverTransport - Connection established
10:57:15.842 [ActiveMQ Task-1] INFO  o.a.a.t.failover.FailoverTransport - Successfully connected to tcp://10.15.0.2:61616
10:57:15.842 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40874] DEBUG o.a.a.transport.WireFormatNegotiator - tcp:///10.15.0.2:61616@40874 before negotiation: OpenWireFormat{version=12, cacheEnabled=false, stackTraceEnabled=false, tightEncodingEnabled=false, sizePrefixDisabled=false, maxFrameSize=9223372036854775807}
10:57:15.842 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40874] DEBUG o.a.a.transport.WireFormatNegotiator - tcp:///10.15.0.2:61616@40874 after negotiation: OpenWireFormat{version=12, cacheEnabled=true, stackTraceEnabled=true, tightEncodingEnabled=true, sizePrefixDisabled=false, maxFrameSize=104857600}
10:57:15.864 [ActiveMQ Transport: tcp:///10.15.0.2:61616@40874] DEBUG o.a.a.thread.TaskRunnerFactory - Initialized TaskRunnerFactory[ActiveMQ Session Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@71acbec7[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
10:57:15.874 [main] DEBUG o.apache.activemq.TransactionContext - Start: io.redit.samples.activemq8050.SampleTest$1@67b7c170, flags: TMNOFLAGS
10:57:15.874 [main] DEBUG o.apache.activemq.TransactionContext - TransactionContext{transactionId=XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263],connection=ActiveMQConnection {id=ID:zmb-virtual-machine-33791-1663901835569-1:2,clientId=CONSUMER,started=true}} started XA transaction XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]
10:57:15.882 [main] INFO  i.r.samples.activemq8050.SampleTest - Found message
10:57:15.883 [main] DEBUG o.apache.activemq.TransactionContext - End: io.redit.samples.activemq8050.SampleTest$1@67b7c170, flags: TMSUCCESS
10:57:15.895 [main] DEBUG o.apache.activemq.TransactionContext - TransactionContext{transactionId=XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263],connection=ActiveMQConnection {id=ID:zmb-virtual-machine-33791-1663901835569-1:2,clientId=CONSUMER,started=true}} ended XA transaction XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]
10:57:15.895 [main] DEBUG o.apache.activemq.TransactionContext - Prepare: io.redit.samples.activemq8050.SampleTest$1@67b7c170
10:57:15.896 [main] INFO  i.r.samples.activemq8050.SampleTest - Simulating dropped connection
10:57:15.897 [main] DEBUG o.a.a.transport.tcp.TcpTransport - Stopping transport tcp:///10.15.0.2:61616@40874
10:57:15.897 [main] DEBUG o.a.a.thread.TaskRunnerFactory - Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@3157e4c0[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
10:57:15.901 [ActiveMQ Task-1] DEBUG o.a.a.transport.tcp.TcpTransport - Closed socket Socket[addr=/10.15.0.2,port=61616,localport=40874]
10:57:15.902 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Forcing shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@3157e4c0[Running, pool size = 1, active threads = 0, queued tasks = 0, completed tasks = 1]
10:57:15.905 [main] WARN  o.a.a.t.failover.FailoverTransport - Transport (tcp://10.15.0.2:61616) failed , attempting to automatically reconnect: {}
java.io.IOException: Fake fail
	at io.redit.samples.activemq8050.SampleTest.failoverWithExceptionProgrammaticBrokers(SampleTest.java:165)
	at io.redit.samples.activemq8050.SampleTest.sampleTest(SampleTest.java:66)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:33)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:220)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:53)
10:57:15.909 [main] DEBUG o.apache.activemq.ActiveMQConnection - transport interrupted - processing required, dispatchers: 1
10:57:15.909 [main] DEBUG o.apache.activemq.ActiveMQConnection - notified failover transport (unconnected) of pending interruption processing for: ID:zmb-virtual-machine-33791-1663901835569-1:2
10:57:15.909 [ActiveMQ Task-2] DEBUG o.a.a.t.failover.FailoverTransport - urlList connectionList:[tcp://10.15.0.3:61616, tcp://10.15.0.2:61616], from: [tcp://10.15.0.2:61616, tcp://10.15.0.3:61616]
10:57:15.909 [ActiveMQ Task-2] DEBUG o.a.a.t.failover.FailoverTransport - Waiting 10 ms before attempting connection
10:57:15.917 [ActiveMQConnection[ID:zmb-virtual-machine-33791-1663901835569-1:2] Scheduler] DEBUG o.a.activemq.ActiveMQMessageConsumer - ID:zmb-virtual-machine-33791-1663901835569-1:2:1:1 clearing unconsumed list (0) on transport interrupt
10:57:15.917 [ActiveMQConnection[ID:zmb-virtual-machine-33791-1663901835569-1:2] Scheduler] DEBUG o.apache.activemq.ActiveMQConnection - transportInterruptionProcessingComplete: 0 for:ID:zmb-virtual-machine-33791-1663901835569-1:2
10:57:15.920 [ActiveMQ Task-2] DEBUG o.a.a.t.failover.FailoverTransport - Attempting 0th connect to: tcp://10.15.0.3:61616
10:57:15.921 [ActiveMQ Task-2] DEBUG o.a.a.transport.WireFormatNegotiator - Sending: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=9223372036854775807, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.931 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.InactivityMonitor - Using min of local: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=9223372036854775807, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]} and remote: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=104857600, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.932 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.WireFormatNegotiator - Received WireFormat: WireFormatInfo { version=12, properties={TcpNoDelayEnabled=true, SizePrefixDisabled=false, CacheSize=1024, ProviderName=ActiveMQ, StackTraceEnabled=true, PlatformDetails=Java, CacheEnabled=true, TightEncodingEnabled=true, MaxFrameSize=104857600, MaxInactivityDuration=30000, MaxInactivityDurationInitalDelay=10000, ProviderVersion=5.15.9}, magic=[A,c,t,i,v,e,M,Q]}
10:57:15.933 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.WireFormatNegotiator - tcp:///10.15.0.3:61616@39176 before negotiation: OpenWireFormat{version=12, cacheEnabled=false, stackTraceEnabled=false, tightEncodingEnabled=false, sizePrefixDisabled=false, maxFrameSize=9223372036854775807}
10:57:15.933 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.WireFormatNegotiator - tcp:///10.15.0.3:61616@39176 after negotiation: OpenWireFormat{version=12, cacheEnabled=true, stackTraceEnabled=true, tightEncodingEnabled=true, sizePrefixDisabled=false, maxFrameSize=104857600}
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - conn: ID:zmb-virtual-machine-33791-1663901835569-1:2
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - session: ID:zmb-virtual-machine-33791-1663901835569-1:2:-1
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - restore consumer: ID:zmb-virtual-machine-33791-1663901835569-1:2:-1:1 in pull mode pending recovery, overriding prefetch: 1000
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - consumer: ID:zmb-virtual-machine-33791-1663901835569-1:2:-1:1
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - session: ID:zmb-virtual-machine-33791-1663901835569-1:2:1
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - restore consumer: ID:zmb-virtual-machine-33791-1663901835569-1:2:1:1 in pull mode pending recovery, overriding prefetch: 1000
10:57:15.934 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - consumer: ID:zmb-virtual-machine-33791-1663901835569-1:2:1:1
10:57:15.935 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - tx: XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]
10:57:15.936 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - tx replay: TransactionInfo {commandId = 5, responseRequired = false, type = 0, connectionId = ID:zmb-virtual-machine-33791-1663901835569-1:2, transactionId = XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]}
10:57:15.936 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - tx replay: TransactionInfo {commandId = 7, responseRequired = true, type = 7, connectionId = ID:zmb-virtual-machine-33791-1663901835569-1:2, transactionId = XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]}
10:57:15.936 [ActiveMQ Task-2] DEBUG o.a.a.state.ConnectionStateTracker - tx replay: TransactionInfo {commandId = 8, responseRequired = true, type = 1, connectionId = ID:zmb-virtual-machine-33791-1663901835569-1:2, transactionId = XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]}
10:57:15.936 [ActiveMQ Task-2] DEBUG o.a.a.t.failover.FailoverTransport - Connection established
10:57:15.936 [ActiveMQ Task-2] INFO  o.a.a.t.failover.FailoverTransport - Successfully reconnected to tcp://10.15.0.3:61616
10:57:15.936 [ActiveMQConnection[ID:zmb-virtual-machine-33791-1663901835569-1:2] Scheduler] DEBUG o.a.a.state.ConnectionStateTracker - restored recovering consumer: ID:zmb-virtual-machine-33791-1663901835569-1:2:1:1 with: 1000
10:57:15.937 [ActiveMQConnection[ID:zmb-virtual-machine-33791-1663901835569-1:2] Scheduler] DEBUG o.a.a.state.ConnectionStateTracker - restored recovering consumer: ID:zmb-virtual-machine-33791-1663901835569-1:2:-1:1 with: 1000
10:57:15.938 [ActiveMQConnection[ID:zmb-virtual-machine-33791-1663901835569-1:2] Scheduler] DEBUG o.apache.activemq.ActiveMQConnection - notified failover transport (tcp://10.15.0.3:61616) of interruption completion for: ID:zmb-virtual-machine-33791-1663901835569-1:2
10:57:15.938 [ActiveMQConnection[ID:zmb-virtual-machine-33791-1663901835569-1:2] Scheduler] DEBUG o.a.activemq.ActiveMQMessageConsumer - ID:zmb-virtual-machine-33791-1663901835569-1:2:1:1 tracking existing transacted null delivered list (1) on transport interrupt
10:57:15.942 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.ResponseCorrelator - Received unexpected response: {Response {commandId = 0, responseRequired = false, correlationId = 1}}for command id: 1
10:57:15.950 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.ResponseCorrelator - Received unexpected response: {Response {commandId = 0, responseRequired = false, correlationId = 2}}for command id: 2
10:57:15.966 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.ResponseCorrelator - Received unexpected response: {Response {commandId = 0, responseRequired = false, correlationId = 4}}for command id: 4
10:57:15.969 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.ResponseCorrelator - Received unexpected response: {Response {commandId = 0, responseRequired = false, correlationId = 7}}for command id: 7
10:57:15.970 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.a.transport.ResponseCorrelator - Received unexpected response: {IntegerResponse {commandId = 0, responseRequired = false, correlationId = 8, result = 3}}for command id: 8
10:57:16.041 [main] DEBUG o.apache.activemq.TransactionContext - Commit: io.redit.samples.activemq8050.SampleTest$1@67b7c170, onePhase=false
10:57:16.044 [main] WARN  o.apache.activemq.TransactionContext - commit of: XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263] failed with: javax.jms.JMSException: Transaction 'XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]' has not been started. xaErrorCode:-4
javax.jms.JMSException: Transaction 'XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]' has not been started. xaErrorCode:-4
	at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:54)
	at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1403)
	at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1436)
	at org.apache.activemq.TransactionContext.commit(TransactionContext.java:585)
	at io.redit.samples.activemq8050.SampleTest.failoverWithExceptionProgrammaticBrokers(SampleTest.java:170)
	at io.redit.samples.activemq8050.SampleTest.sampleTest(SampleTest.java:66)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:33)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:220)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:53)
Caused by: javax.transaction.xa.XAException: Transaction 'XID:[86,globalId=001ffffff8368472263,branchId=001ffffff8368472263]' has not been started. xaErrorCode:-4
	at org.apache.activemq.transaction.Transaction.newXAException(Transaction.java:213)
	at org.apache.activemq.broker.TransactionBroker.getTransaction(TransactionBroker.java:351)
	at org.apache.activemq.broker.TransactionBroker.commitTransaction(TransactionBroker.java:251)
	at org.apache.activemq.broker.BrokerFilter.commitTransaction(BrokerFilter.java:114)
	at org.apache.activemq.broker.TransportConnection.processCommitTransactionTwoPhase(TransportConnection.java:544)
	at org.apache.activemq.command.TransactionInfo.visit(TransactionInfo.java:102)
	at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:336)
	at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:200)
	at org.apache.activemq.transport.MutexTransport.onCommand(MutexTransport.java:50)
	at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:125)
	at org.apache.activemq.transport.AbstractInactivityMonitor.onCommand(AbstractInactivityMonitor.java:301)
	at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)
	at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:233)
	at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:215)
	at java.lang.Thread.run(Thread.java:748)
10:57:16.044 [main] INFO  i.r.samples.activemq8050.SampleTest - Recreated error successfully
10:57:16.048 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@4f4c789f[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0] is shutdown: true and terminated: true took: 0.000 seconds.
10:57:16.048 [main] DEBUG o.a.a.t.failover.FailoverTransport - Stopped tcp://10.15.0.2:61616
10:57:16.048 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Forcing shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@3fae596[Running, pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2]
10:57:16.049 [main] DEBUG o.a.a.transport.tcp.TcpTransport - Stopping transport tcp:///10.15.0.2:61616@40872
10:57:16.049 [main] DEBUG o.a.a.thread.TaskRunnerFactory - Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@13f9ad9[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
10:57:16.051 [ActiveMQ Task-1] DEBUG o.a.a.transport.tcp.TcpTransport - Closed socket Socket[addr=/10.15.0.2,port=61616,localport=40872]
10:57:16.051 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Forcing shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@13f9ad9[Running, pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
10:57:16.070 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@71acbec7[Shutting down, pool size = 1, active threads = 0, queued tasks = 0, completed tasks = 2] is shutdown: true and terminated: false took: 0.000 seconds.
10:57:16.071 [ActiveMQ Transport: tcp:///10.15.0.3:61616@39176] DEBUG o.a.activemq.util.ThreadPoolUtils - Shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@370e300c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0] is shutdown: true and terminated: true took: 0.002 seconds.
10:57:16.071 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@7048535f[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0] is shutdown: true and terminated: true took: 0.000 seconds.
10:57:16.071 [main] DEBUG o.a.a.t.failover.FailoverTransport - Stopped tcp://10.15.0.3:61616
10:57:16.071 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Forcing shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@4393593c[Running, pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 4]
10:57:16.071 [main] DEBUG o.a.a.transport.tcp.TcpTransport - Stopping transport tcp:///10.15.0.3:61616@39176
10:57:16.071 [main] DEBUG o.a.a.thread.TaskRunnerFactory - Initialized TaskRunnerFactory[ActiveMQ Task] using ExecutorService: java.util.concurrent.ThreadPoolExecutor@e3994ef[Running, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
10:57:16.076 [ActiveMQ Task-1] DEBUG o.a.a.transport.tcp.TcpTransport - Closed socket Socket[addr=/10.15.0.3,port=61616,localport=39176]
10:57:16.077 [main] DEBUG o.a.activemq.util.ThreadPoolUtils - Forcing shutdown of ExecutorService: java.util.concurrent.ThreadPoolExecutor@e3994ef[Running, pool size = 1, active threads = 0, queued tasks = 0, completed tasks = 1]
10:57:18.077 [main] INFO  i.r.samples.activemq8050.SampleTest - server1 checkServer...
10:57:18.427 [main] INFO  i.r.samples.activemq8050.SampleTest - server1: cd /activemq/activemq-5.15.3/mq1 && bin/activemq status
10:57:18.427 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq1//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '47')

10:57:18.427 [main] INFO  i.r.samples.activemq8050.SampleTest - server1: cd /activemq/activemq-5.15.3/mq2 && bin/activemq status
10:57:18.427 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq2//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '92')

10:57:18.427 [main] INFO  i.r.samples.activemq8050.SampleTest - server1: cd /activemq/activemq-5.15.3/mq3 && bin/activemq status
10:57:18.427 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq3//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '139')

10:57:20.427 [main] INFO  i.r.samples.activemq8050.SampleTest - server2 checkServer...
10:57:20.761 [main] INFO  i.r.samples.activemq8050.SampleTest - server2: cd /activemq/activemq-5.15.3/mq1 && bin/activemq status
10:57:20.761 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq1//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '47')

10:57:20.761 [main] INFO  i.r.samples.activemq8050.SampleTest - server2: cd /activemq/activemq-5.15.3/mq2 && bin/activemq status
10:57:20.761 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq2//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '93')

10:57:20.761 [main] INFO  i.r.samples.activemq8050.SampleTest - server2: cd /activemq/activemq-5.15.3/mq3 && bin/activemq status
10:57:20.761 [main] INFO  i.r.samples.activemq8050.SampleTest - INFO: Loading '/activemq/activemq-5.15.3/mq3//bin/env'
INFO: Using java '/usr/local/openjdk-8/bin/java'
ActiveMQ is running (pid '138')

10:57:22.761 [main] INFO  i.r.samples.activemq8050.SampleTest - completed !!!

