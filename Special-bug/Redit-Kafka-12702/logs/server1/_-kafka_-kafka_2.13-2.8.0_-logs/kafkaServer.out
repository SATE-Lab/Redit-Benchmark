[2022-08-25 08:36:56,868] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2022-08-25 08:36:57,677] INFO Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation (org.apache.zookeeper.common.X509Util)
[2022-08-25 08:36:58,329] INFO [Log partition=@metadata-0, dir=/kafka/kafka_2.12-2.8.0/logs] Loading producer state till offset 0 with message format version 2 (kafka.log.Log)
[2022-08-25 08:36:58,481] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2022-08-25 08:36:58,967] INFO [RaftManager nodeId=1] Completed transition to Unattached(epoch=0, voters=[1, 2, 3], electionTimeoutMs=1841) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:36:59,043] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2022-08-25 08:36:59,073] INFO [kafka-raft-outbound-request-thread]: Starting (kafka.raft.RaftSendThread)
[2022-08-25 08:36:59,075] INFO Starting controller (kafka.server.ControllerServer)
[2022-08-25 08:36:59,076] INFO [kafka-raft-io-thread]: Starting (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:00,092] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2022-08-25 08:37:00,098] INFO Awaiting socket connections on 0.0.0.0:19091. (kafka.network.Acceptor)
[2022-08-25 08:37:00,149] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2022-08-25 08:37:00,206] INFO [ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,211] INFO [ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,212] INFO [ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,225] INFO [ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,240] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Starting socket server acceptors and processors (kafka.network.SocketServer)
[2022-08-25 08:37:00,274] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Started data-plane acceptor and processor(s) for endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2022-08-25 08:37:00,279] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Started socket server acceptors and processors (kafka.network.SocketServer)
[2022-08-25 08:37:00,280] INFO [BrokerServer id=1] Starting broker (kafka.server.BrokerServer)
[2022-08-25 08:37:00,297] INFO [ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,299] INFO [ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,300] INFO [ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,308] INFO [ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:00,376] INFO [RaftManager nodeId=1] Completed transition to Candidate(localId=1, epoch=1, retries=1, electionTimeoutMs=1260) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:00,538] INFO [broker-1-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:00,664] INFO [RaftManager nodeId=1] Vote request VoteRequestData(clusterId=null, topics=[TopicData(topicName='@metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=1, candidateId=3, lastOffsetEpoch=0, lastOffset=0)])]) is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:00,697] INFO [RaftManager nodeId=1] Vote request VoteRequestData(clusterId=null, topics=[TopicData(topicName='@metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=1, candidateId=2, lastOffsetEpoch=0, lastOffset=0)])]) is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:00,811] INFO [RaftManager nodeId=1] Completed transition to Unattached(epoch=2, voters=[1, 2, 3], electionTimeoutMs=825) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:00,815] INFO [RaftManager nodeId=1] Completed transition to Voted(epoch=2, votedId=2, voters=[1, 2, 3], electionTimeoutMs=1649) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:00,815] INFO [RaftManager nodeId=1] Vote request VoteRequestData(clusterId=null, topics=[TopicData(topicName='@metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=2, candidateId=2, lastOffsetEpoch=0, lastOffset=0)])]) is granted (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:00,866] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2022-08-25 08:37:00,866] INFO Awaiting socket connections on 0.0.0.0:9092. (kafka.network.Acceptor)
[2022-08-25 08:37:00,930] INFO [SocketServer listenerType=BROKER, nodeId=1] Created data-plane acceptor and processors for endpoint : ListenerName(PLAINTEXT) (kafka.network.SocketServer)
[2022-08-25 08:37:00,975] INFO [broker-1-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,021] INFO [ExpirationReaper-1-Produce]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,052] INFO [ExpirationReaper-1-ElectLeader]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,044] INFO [ExpirationReaper-1-DeleteRecords]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,052] INFO [ExpirationReaper-1-Fetch]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,099] INFO [ExpirationReaper-1-Heartbeat]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,126] INFO [ExpirationReaper-1-Rebalance]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,218] INFO [RaftManager nodeId=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=2, leaderId=2, voters=[1, 2, 3]) (org.apache.kafka.raft.QuorumState)
[2022-08-25 08:37:01,311] INFO [broker-1-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,313] INFO [broker-1-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,313] INFO [broker-1-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,315] INFO [broker-1-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,467] INFO [BrokerLifecycleManager id=1] Incarnation RL5CytNdT0K8PoIG6ZpatA of broker 1 in cluster PHc7E0K_QfWCJcvTMswIXg is now STARTING. (kafka.server.BrokerLifecycleManager)
[2022-08-25 08:37:01,474] INFO [broker-1-to-controller-send-thread]: Starting (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,475] INFO [broker-1-to-controller-send-thread]: Recorded new controller, from now on will use broker redit_sample-kafka_server2_1661416599.redit_sample-kafka_1661416598:19091 (id: 2 rack: null) (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,506] ERROR [broker-1-to-controller-send-thread]: unhandled exception caught in InterBrokerSendThread (kafka.server.BrokerToControllerRequestThread)
java.lang.NullPointerException
	at org.apache.kafka.common.message.BrokerRegistrationRequestData$Listener.addSize(BrokerRegistrationRequestData.java:515)
	at org.apache.kafka.common.message.BrokerRegistrationRequestData.addSize(BrokerRegistrationRequestData.java:216)
	at org.apache.kafka.common.protocol.SendBuilder.buildSend(SendBuilder.java:218)
	at org.apache.kafka.common.protocol.SendBuilder.buildRequestSend(SendBuilder.java:187)
	at org.apache.kafka.common.requests.AbstractRequest.toSend(AbstractRequest.java:101)
	at org.apache.kafka.clients.NetworkClient.doSend(NetworkClient.java:525)
	at org.apache.kafka.clients.NetworkClient.doSend(NetworkClient.java:501)
	at org.apache.kafka.clients.NetworkClient.send(NetworkClient.java:461)
	at kafka.common.InterBrokerSendThread.$anonfun$sendRequests$1(InterBrokerSendThread.scala:104)
	at kafka.common.InterBrokerSendThread.$anonfun$sendRequests$1$adapted(InterBrokerSendThread.scala:99)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.common.InterBrokerSendThread.sendRequests(InterBrokerSendThread.scala:99)
	at kafka.common.InterBrokerSendThread.pollOnce(InterBrokerSendThread.scala:73)
	at kafka.server.BrokerToControllerRequestThread.doWork(BrokerToControllerChannelManager.scala:368)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-25 08:37:01,531] INFO [broker-1-to-controller-send-thread]: Stopped (kafka.server.BrokerToControllerRequestThread)
[2022-08-25 08:37:01,532] INFO [kafka-raft-io-thread]: Shutting down (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,532] INFO [RaftManager nodeId=1] Beginning graceful shutdown (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:01,533] INFO [RaftManager nodeId=1] Graceful shutdown completed (org.apache.kafka.raft.KafkaRaftClient)
[2022-08-25 08:37:01,540] INFO [kafka-raft-io-thread]: Stopped (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,541] INFO [kafka-raft-io-thread]: Completed graceful shutdown of RaftClient (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,542] INFO [kafka-raft-io-thread]: Shutdown completed (kafka.raft.KafkaRaftManager$RaftIoThread)
[2022-08-25 08:37:01,660] INFO [kafka-raft-outbound-request-thread]: Shutting down (kafka.raft.RaftSendThread)
[2022-08-25 08:37:01,674] INFO [kafka-raft-outbound-request-thread]: Stopped (kafka.raft.RaftSendThread)
[2022-08-25 08:37:01,675] INFO [kafka-raft-outbound-request-thread]: Shutdown completed (kafka.raft.RaftSendThread)
[2022-08-25 08:37:01,684] INFO [ExpirationReaper-1-AlterAcls]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2022-08-25 08:37:01,726] INFO [ProducerStateManager partition=@metadata-0] Writing producer snapshot at offset 1 (kafka.log.ProducerStateManager)
[2022-08-25 08:37:01,846] INFO [ControllerServer id=1] shutting down (kafka.server.ControllerServer)
[2022-08-25 08:37:01,847] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Stopping socket server request processors (kafka.network.SocketServer)
[2022-08-25 08:37:01,891] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Stopped socket server request processors (kafka.network.SocketServer)
[2022-08-25 08:37:01,906] INFO [Controller 1] QuorumController#beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2022-08-25 08:37:01,907] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Shutting down socket server (kafka.network.SocketServer)
[2022-08-25 08:37:02,031] INFO [SocketServer listenerType=CONTROLLER, nodeId=1] Shutdown completed (kafka.network.SocketServer)
[2022-08-25 08:37:02,032] INFO [data-plane Kafka Request Handler on Broker 1], shutting down (kafka.server.KafkaRequestHandlerPool)
[2022-08-25 08:37:02,038] INFO [data-plane Kafka Request Handler on Broker 1], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2022-08-25 08:37:02,038] INFO [ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:02,209] INFO [ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:02,209] INFO [ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:02,209] INFO [ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:02,216] INFO [ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:02,216] INFO [ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:02,216] INFO [ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,212] INFO [ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,212] INFO [ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,213] INFO [ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,232] INFO [ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,232] INFO [ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2022-08-25 08:37:03,233] INFO [Controller 1] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2022-08-25 08:37:03,234] INFO App info kafka.server for 1 unregistered (org.apache.kafka.common.utils.AppInfoParser)
