package mrapps;

import mr.KeyValue;
import java.util.ArrayList;

public class WordCount {

    /**
     The map function is called once for each file of input. The first argument is the name of the input file,
     and the second is the file's complete contents. You should ignore the input file name,
     and look only at the contents argument. The return value is a slice of key/value pairs.
     */
    public static ArrayList<KeyValue> map(StringBuffer content){
        // 自定义split方法: ArrayList<String> wordList = Util.contentSplit(content);
        String[] results = new String(content).split("\\s+|,|\\.|: |\\?|\'|\"|;|!|#|\\$|\\(|\\)|\\*|-|%|\\[|]");
        ArrayList<KeyValue> keyValues = new ArrayList<>();
        for (String word:results){
            KeyValue keyValue = new KeyValue(word, 1);
            keyValues.add(keyValue);
        }
        return keyValues;
    }

    /**
     The reduce function is called once for each key generated by the map tasks,
     with a list of all the values created for that key by any map task.
     */
    public static int reduce(ArrayList<Integer> values){
        return values.size();
    }


}
